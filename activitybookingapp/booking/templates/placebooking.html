<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity booking</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div class="py-16 flex flex-col items-center justify-center gap-10 ">
        <p class="text-amber-800 text-xl font-medium">Booking Football playground</p>
        
        <div class="p-4 ">
            <p class="text-xl mb-10">Select Date</p>
            <div id="calendarContainer" class='flex flex-row gap-16'></div>

            
            
            <div class = 'hidden' id='selecttime'>
                <p class='text-xl mt-10 mb-5'>Select Time</p>
                <div class='grid grid-cols-3 gap-7  pt-5'>
                    <div class='p-2 shadow-md text-center'>10.00 - 11.00</div>
                    <div class='p-2 shadow-md text-center'>11.00 - 12.00</div>
                    <div class='p-2 shadow-md text-center'>12.00 - 13.00</div>
                    <div class='p-2 shadow-md text-center'>13.00 - 14.00</div>
                    <div class='p-2 shadow-md text-center'>14.00 - 15.00</div>
                    <div class='p-2 shadow-md text-center'>15.00 - 16.00</div>
                    <div class='p-2 shadow-md text-center'>16.00 - 17.00</div>
                    <div class='p-2 shadow-md text-center'>17.00 - 18.00</div>
                    <div class='p-2 shadow-md text-center'>18.00 - 19.00</div>
                    <div class='p-2 shadow-md text-center'>19.00 - 20.00</div>
                </div>
                
                <div></div>
            </div>
        </div>



        <div class="flex">
            <form method="post" class="flex flex-col gap-9 " >
                {% csrf_token %}
                <div class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                    {{form.booking_date.errors}}
                    {{form.booking_date.label_tag}}
                    {{form.booking_date}}
                </div>
                <div class = "mr-5">
                    {{form.student.errors}}
                    {{form.student.label_tag}}
                    {{form.student}}
                </div>
                <div>
                    {{form.place.errors}}
                    {{form.place.label_tag}}
                    {{form.place}}
                </div>
                <div>
                    {{form.status.errors}}
                    {{form.status.label_tag}}
                    {{form.status}}
                </div>
                <button type="submit" class="p-2 bg-yellow-400 rounded-lg text-black">Booking</button>
            </form>
        </div>
    </div>
</body>

<script>
    const lang = navigator.language;
    const calendarContainer = document.getElementById('calendarContainer');
    let currentDate = new Date();

    let selectedDate = null; 
    let date = localStorage.getItem('selectDayID')

    function selectCalendar(dayDiv, day, month, year) {


        if (selectedDate) {
            selectedDate.classList.remove('bg-green-200');
        }
    
        dayDiv.classList.add('bg-green-200');
        selectedDate = dayDiv;

        localStorage.setItem('selectDayID', dayDiv.id)
    
        let bookingdate = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

        console.log(bookingdate);

        let time = document.getElementById('selecttime')

        time.classList.remove('hidden');
    
    }

    for (let i = 0; i < 4; i++) {  // 0 is today, and we loop to get the next 3 days
        let date = new Date(currentDate);
        date.setDate(currentDate.getDate() + i);

        let dayNumber = date.getDate();
        let monthName = date.toLocaleString(lang, { month: 'long' });
        let month = date.getMonth() + 1; 
        let dayName = date.toLocaleString(lang, { weekday: 'long' });
        let year = date.getFullYear();

        // Create a new div element for each day
        let dayDiv = document.createElement('div');
        dayDiv.id = dayNumber

        dayDiv.innerHTML = `
            <p class="text-xl text-gray-800 text-right">${year}</p>
            <p class="mt-2 text-xl font-light text-gray-600">${monthName}</p>
            <p class="mt-2 text-xl font-light text-gray-600 text-green-700 text-center">${dayName}</p>
            <p class="mt-2 text-5xl text-gray-800 text-center">${dayNumber}</p>
        `;

        dayDiv.className = `mb-4 ${i == 0 ? 'rounded-3xl p-5 bg-yellow-200 ': 'rounded-3xl p-5 bg-white'}`

        dayDiv.onclick = () => {
            selectCalendar(dayDiv, dayNumber, month, year)
            
        }

        calendarContainer.appendChild(dayDiv);
    }

    if(date != null){
        document.getElementById(date).className = 'rounded-3xl p-5 bg-green-200'
        console.log(date)
    }
    

</script>
</html>